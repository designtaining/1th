<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


    <style>
        .story_container {
            width: 100%;
            position: relative;
            isolation: isolate;
        }

        .story_bg_layer {
            position: fixed;
            inset: 0;
            background: #ffff99;
            opacity: 0;
            pointer-events: none;
            z-index: 0;
        }

        .story_container>*:not(.story_bg_layer) {
            position: relative;
            z-index: 1;
        }

        .story_wrapper {
            width: 90%;
            aspect-ratio: 16 / 9;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .story_first_box {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .first_title {
            font-family: 'Pretendard';
            font-size: 100px;
            font-weight: 700;
            color: #111111;
            text-align: center;
            margin: 0;
        }

        /* 첫번째 파트 끝 */

        .story_second_box {
            width: 100%;
            height: 90%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 20px;
        }

        .story_second_top {
            flex: 0 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .second_title {
            font-family: 'Pretendard';
            font-size: 32px;
            font-weight: 700;
            color: #111111;
            text-align: center;
            line-height: 1.4;
            margin: 0;
        }

        .second_desc {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 400;
            color: #767676;
            text-align: center;
            line-height: 1.4;
            margin: 0;
        }

        .story_second_bottom {
            flex: 1 1 auto;
            width: 70%;
            display: flex;
            gap: 20px;
            margin: 0 auto;
        }

        .second_bottom_left {
            flex: 1 1 0;
        }

        .second_left_box {
            width: 100%;
            height: 100%;
            background-color: #e5e5ec;
            border-radius: 24px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .second_left_box video {
            position: absolute;
            z-index: 1;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 24px;
        }

        .second_name_tag {
            position: absolute;
            z-index: 2;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .second_name_title {
            font-family: 'Pretendard';
            font-size: 24px;
            font-weight: 400;
            color: #ffffff;
            margin: 0;
        }

        .second_name_desc {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 400;
            color: #ffffff;
            margin: 0;
        }

        .second_right_box {
            flex: 2 1 0;
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: 100%;
        }

        .second_right_top,
        .second_right_bottom {
            flex: 1 1 0;
            display: flex;
            gap: 20px;
        }

        .second_box1,
        .second_box2 {
            flex: 1 1 0;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
        }

        .second_box1 {
            background-image: url(https://ncryk7.mycafe24.com/storysecond1.png);
            background-size: cover;
        }

        .second_box2 {
            background-image: url(https://ncryk7.mycafe24.com/storysecond2.png);
            background-size: cover;
        }

        .second_last_box {
            width: 100%;
            height: 100%;
            border-radius: 24px;
            background-image: url(https://ncryk7.mycafe24.com/storysecond3.png);
            background-size: cover;
            overflow: hidden;
            position: relative;
        }

        /* 두번째끝!!!!!!!!!! */

        .story_third_box {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 16px;
        }

        .third_title {
            font-family: 'Pretendard';
            font-size: 80px;
            font-weight: 700;
            color: #111111;
            margin: 0;
        }

        .third_desc {
            width: 680px;
            font-family: 'Pretendard';
            font-size: 24px;
            font-weight: 400;
            color: #111111;
            margin: 0;
            line-height: 1.4;
            text-align: center;
        }

        /* 세번째 끝!!!!!!!! */

        .story_fourth_box {
            width: 70%;
            height: 80%;
            display: flex;
            flex-direction: column;
            margin: 0 auto;
            gap: 20px;
        }

        .fourth_top_box {
            width: 100%;
            height: 100%;
            display: flex;
            gap: 20px;
        }

        .fourth_left {
            width: 100%;
            height: 100%;
            background-image: url(https://ncryk7.mycafe24.com/fourth1.png);
            background-size: cover;
            border-radius: 16px;
        }

        .fourth_right {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .fourth_right_top {
            width: 100%;
            height: 100%;
            background-color: #b4cbdb;
            border-radius: 16px;
        }

        .fourth_right_bottom {
            width: 100%;
            height: 100%;
            background-color: #b4cbdb;
            border-radius: 16px;
        }

        .fourth_right_profile1 {
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 12px;
        }

        .frpo1 {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .frpo1>img {
            width: 32px;
            height: 32px;
            border-radius: 999px;
        }

        .frpo_name1 {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 600;
            color: #111111;
            margin: 0;
        }

        .frpod_desc1_box {
            display: flex;
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
        }

        .frpod_desc1 {
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 400;
            color: #111111;
            margin: 0;
            line-height: 1.4;
        }

        .fourth_right_profile2 {
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 12px;
        }

        .frpo2 {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .frpo2>img {
            width: 32px;
            height: 32px;
            border-radius: 999px;
        }

        .frpo_name2 {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 600;
            color: #111111;
            margin: 0;
        }

        .frpod_desc2_box {
            display: flex;
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
        }

        .frpod_desc2 {
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 400;
            color: #111111;
            margin: 0;
            line-height: 1.4;
        }

        .fourth_bottom_box {
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
            background-color: #4768C9;
            border-radius: 16px;
        }

        .fourth_last_box {
            display: flex;
            justify-content: space-between;
        }

        .fourth_last_title_box {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .last_title {
            font-family: 'Pretendard';
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
            margin: 0;
        }

        .last_desc {
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 400;
            color: #eeeeee;
            margin: 0;
        }

        .fourth_last_img_box {
            width: 120px;
            height: 120px;
        }

        .fourth_last_img_box>img {
            width: 100%;
            height: 100%;
        }

        /* 네번째 끝!!!!!!!!!!!!1 */

        .story_fifth_box {
            width: 80%;
            height: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 20px;
        }

        .fifth_top_box {
            display: flex;
            gap: 20px;
        }

        .fifth_card {
            width: 100%;
            height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 60px;
            box-sizing: border-box;
            border-radius: 16px;
            background-color: #e5e5ec;
        }

        .fifth_card_title_box {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .fifth_eng_title {
            font-family: 'Pretendard';
            font-size: 24px;
            font-weight: 500;
            color: #111111;
            margin: 0;
            text-align: center;
        }

        .fifth_title {
            font-family: 'Pretendard';
            font-size: 24px;
            font-weight: 500;
            color: #111111;
            margin: 0;
            text-align: center;
        }

        .fifth_card_img_box {
            width: 120px;
            height: 120px;
        }

        .fifth_card_img_box>img {
            width: 100%;
            height: 100%;
        }

        .fifth_bottom_box {
            display: flex;
            flex-direction: column;
            gap: 12px;
            background-color: #e5e5ec;
            border-radius: 16px;
            padding: 20px;
        }

        .fifth_bottom_title {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 500;
            color: #111111;
            margin: 0;
        }

        .fifth_bottom_desc {
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 400;
            color: #111111;
            margin: 0;
        }

        /* 다섯번째 끝!!!!!!! */

        .story_sixth_box {
            width: 90%;
            height: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .story_sixth_title1,
        .story_sixth_title2,
        .story_sixth_title3 {
            font-family: 'Pretendard';
            font-size: 160px;
            font-weight: 700;
            color: #111111;
            margin: 0;
        }

        /* 여섯번째 끝!!!!!!! */

        .story_seventh_box {
            width: 90%;
            height: 100%;
            display: flex;
            align-items: center;
            margin: 0 auto;
            gap: 20px;
        }

        .seventh_left_box {
            width: 40%;
            height: 600px;
            background-image: url(https://ncryk7.mycafe24.com/tiger1.jpg);
            background-size: cover;
        }

        .seventh_right_box {
            height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-end;
            background-color: #b4cbdb;
            border-radius: 24px;
            padding: 20px;
            box-sizing: border-box;
        }

        .seventh_right_last_box {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .seventh_right_profile {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .profile_img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-image: url(https://ncryk7.mycafe24.com/tiger1.jpg);
            background-size: cover;
        }

        .seventh_right_title {
            font-family: 'Pretendard';
            font-size: 20px;
            font-weight: 500;
            color: #111111;
            margin: 0;
        }

        .seventh_right_desc {
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 400;
            color: #111111;
            margin: 0;
            background-color: #ffffff;
            border-radius: 16px;
            padding: 20px;
        }

        .seventh_right_last_link {
            width: 180px;
            padding: 16px 0;
            background-color: #4768C9;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Pretendard';
            font-size: 16px;
            font-weight: 500;
            color: #ffffff;
            margin: 0;
            text-decoration: none;
            border-radius: 999px;
        }
    </style>
</head>

<body>

    <section class="story_container">

        <div class="story_bg_layer" aria-hidden="true"></div>

        <div class="story_wrapper">
            <div class="story_first_box">
                <p class="first_title">
                    OUR STORY <br>
                    <br>
                    Design
                    <br>
                    for your
                    <br>
                    EnterTaining
                </p>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_second_box">
                <div class="story_second_top">
                    <p class="second_title">
                        당사의 비즈니스를 이해함으로 시작해
                        고객의 니즈와 기대를 충족시키기 위해
                        최선을 다함을 약속합니다.
                    </p>
                    <p class="second_desc">
                        컨셉을 유지하고, 요소들을 균형있게 정돈하고, 제품 또는 서비스가 돋보이도록 표현합니다.
                    </p>
                </div>
                <div class="story_second_bottom">
                    <div class="second_bottom_left">

                        <div class="second_left_box">

                            <video autoplay loop muted playsinline>
                                <source src="https://ncryk7.mycafe24.com/hearthand.mp4" type="video/mp4">
                            </video>
                            <div class="second_name_tag">
                                <p class="second_name_title">
                                    Video
                                </p>
                                <p class="second_name_desc">
                                    동영상
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="second_right_box">

                        <div class="second_right_top">
                            <div class="second_box1">
                                <div class="second_name_tag">
                                    <p class="second_name_title">
                                        Image
                                    </p>
                                    <p class="second_name_desc">
                                        이미지
                                    </p>
                                </div>
                            </div>
                            <div class="second_box2">
                                <div class="second_name_tag">
                                    <p class="second_name_title">
                                        Icon
                                    </p>
                                    <p class="second_name_desc">
                                        아이콘
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="second_right_bottom">
                            <div class="second_last_box">
                                <div class="second_name_tag">
                                    <p class="second_name_title">
                                        Concept
                                    </p>
                                    <p class="second_name_desc">
                                        컨셉트
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_third_box">
                <p class="third_title">
                    매력적인 디자인을,
                </p>
                <p class="third_title">
                    효율적인 사용자 경험을,
                </p>
                <p class="third_desc">
                    정보와 메시지를 효과적으로 전달하기 위해서 사용자에게 재미를 더하고,
                    실제 사용자가 편리하게 이용할 수 있는 편리함을 조화롭게 배치합니다.
                </p>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_fourth_box">
                <div class="fourth_top_box">
                    <div class="fourth_left"></div>
                    <div class="fourth_right">
                        <div class="fourth_right_top">
                            <div class="fourth_right_profile1">
                                <div class="frpo1">
                                    <img src="https://ncryk7.mycafe24.com/fourth3.png" alt="">
                                    <p class="frpo_name1">
                                        사용자 중심
                                    </p>
                                </div>
                                <div class="frpod_desc1_box">
                                    <p class="frpod_desc1">
                                        모든 디자인은 사용자의 경험과 입장에서 출발합니다. 고객의 목적과 행동패턴을 기반으로한 인터페이스를 구현하는것이 목표입니다. 보기 쉽게,
                                        이해하기 쉽게, 조작이 직관적일 수 있도록 하는 것이 사용자 중심의 핵심입니다.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="fourth_right_bottom">
                            <div class="fourth_right_profile2">
                                <div class="frpo2">
                                    <img src="https://ncryk7.mycafe24.com/fourth4.png" alt="">
                                    <p class="frpo_name2">
                                        일관성과 익숙함
                                    </p>
                                </div>
                                <div class="frpod_desc2_box">
                                    <p class="frpod_desc2">
                                        브랜드의 톤앤매너를 유지하고, 다양한 UIUX가 일관적인 결과를 주어야 안정을 느낄 수 있습니다. 단순하게 편리함을 넘어서 '좋다',
                                        '편안하다' 라는 감정적인 인상을 제공하면 고객을 부담없이 인도합니다.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="fourth_bottom_box">
                    <div class="fourth_last_box">
                        <div class="fourth_last_title_box">
                            <p class="last_title">
                                UIUX와 브라우저 접근성
                            </p>
                            <p class="last_desc">
                                모든 디바이스의 호환성과 접근성을 고려한 UIUX는 브랜드이미지를 일관성있게 보여주는 장치입니다.
                            </p>
                        </div>
                        <div class="fourth_last_img_box">
                            <img src="https://ncryk7.mycafe24.com/fourth2.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_fifth_box">

                <div class="fifth_top_box">
                    <div class="fifth_card">
                        <div class="fifth_card_title_box">
                            <p class="fifth_eng_title">
                                Identity
                            </p>
                            <p class="fifth_title">
                                브랜드 아이덴티티
                            </p>
                        </div>
                        <div class="fifth_card_img_box">
                            <img src="" alt="">
                        </div>
                    </div>
                    <div class="fifth_card">
                        <div class="fifth_card_title_box">
                            <p class="fifth_eng_title">
                                Performance
                            </p>
                            <p class="fifth_title">
                                퍼포먼스
                            </p>
                        </div>
                        <div class="fifth_card_img_box">
                            <img src="" alt="">
                        </div>
                    </div>
                    <div class="fifth_card">
                        <div class="fifth_card_title_box">
                            <p class="fifth_eng_title">
                                Typography
                            </p>
                            <p class="fifth_title">
                                타이포그래피
                            </p>
                        </div>
                        <div class="fifth_card_img_box">
                            <img src="" alt="">
                        </div>
                    </div>
                    <div class="fifth_card">
                        <div class="fifth_card_title_box">
                            <p class="fifth_eng_title">
                                Content
                            </p>
                            <p class="fifth_title">
                                컨텐츠
                            </p>
                        </div>
                        <div class="fifth_card_img_box">
                            <img src="" alt="">
                        </div>
                    </div>
                    <div class="fifth_card">
                        <div class="fifth_card_title_box">
                            <p class="fifth_eng_title">
                                Interaction
                            </p>
                            <p class="fifth_title">
                                인터랙션
                            </p>
                        </div>
                        <div class="fifth_card_img_box">
                            <img src="" alt="">
                        </div>
                    </div>
                </div>

                <div class="fifth_bottom_box">
                    <p class="fifth_bottom_title">
                        각 단계의 세밀한 설계와 분석을 통해 완성도를 높이고, 전략적 사고로 고객의 비즈니스 성장을 돕습니다.
                    </p>
                    <p class="fifth_bottom_desc">
                        명확한 목표와 일관된 기준으로 프로젝트를 완성하며, 고객의 기대를 넘어서는 디자인 결과를 제공합니다.
                    </p>
                </div>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_sixth_box">
                <p class="story_sixth_title1">
                    Imagination
                </p>
                <p class="story_sixth_title2">
                    Connection
                </p>
                <p class="story_sixth_title3">
                    Creative
                </p>
            </div>
        </div>

        <div class="story_wrapper">
            <div class="story_seventh_box">
                <div class="seventh_left_box"></div>
                <div class="seventh_right_box">
                    <div class="seventh_right_last_box">
                        <div class="seventh_right_profile">
                            <div class="profile_img">
                            </div>
                            <p class="seventh_right_title">
                                디자인테이닝 일동.
                            </p>
                        </div>
                        <p class="seventh_right_desc">
                            찾아주시는 모든분들께 감사의 말씀을 드리며, 최고의 서비스를 제공할 수 있도록 최선의 노력을 보여드리겠습니다.
                        </p>
                    </div>
                    <a href="#" class="seventh_right_last_link">
                        설문지 작성하기
                    </a>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger);

        /* ===== 전역 설정 ===== */
        const CFG = {
            distance: 56,        // 아래에서 시작 오프셋(px)
            scrollLen: "130%",   // 각 섹션 pin 길이
            scrub: 0.6,          // 스크럽 감도
            ease: "power2.out"   // 슬라이드업 이징
        };
        const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        const setUp = (el) => el && gsap.set(el, { y: CFG.distance, autoAlpha: 0, willChange: "transform,opacity" });

        /* ===== 섹션 타임라인 빌더 ===== */
        function buildSectionTimeline(sec, idx) {
            const q = (sel) => sec.querySelector(sel);
            const qa = (sel) => sec.querySelectorAll(sel);

            let groupA = [], groupB = [], groupC = [];

            // 섹션 1: OUR STORY
            if (q(".story_first_box")) {
                gsap.set(q(".first_title"), { y: 0, autoAlpha: 1 });
                return;
            }

            // 섹션 2
            if (q(".story_second_box")) {
                groupA = [
                    q(".second_left_box"),
                    q(".second_box1"),
                    q(".second_box2"),
                    q(".second_last_box"),
                ].filter(Boolean);
                groupB = [q(".second_title"), q(".second_desc")].filter(Boolean);
                groupC = qa(".second_name_tag");
            }

            // 섹션 3
            if (q(".story_third_box")) {
                groupA = [...qa(".third_title")];
                groupB = [q(".third_desc")].filter(Boolean);
            }

            // 섹션 4
            if (q(".story_fourth_box")) {
                groupA = [q(".fourth_left"), q(".fourth_right_top"), q(".fourth_right_bottom")].filter(Boolean);
                groupB = [q(".fourth_bottom_box")].filter(Boolean);
                groupC = [q(".last_title"), q(".last_desc")].filter(Boolean);
            }

            // 섹션 5: 카드 펼쳐짐
            if (q(".story_fifth_box")) {
                const cards = [...qa(".fifth_card")];
                const bottomBox = q(".fifth_bottom_box");

                if (prefersReduced) {
                    cards.forEach(el => gsap.set(el, { x: 0, scale: 1, autoAlpha: 1 }));
                    bottomBox && gsap.set(bottomBox, { y: 0, autoAlpha: 1 });
                } else {
                    const center = Math.floor((cards.length - 1) / 2);
                    const pull = 140;

                    gsap.set(cards, {
                        x: (i) => (center - i) * pull,
                        scale: 0.88,
                        autoAlpha: 0,
                        zIndex: (i) => 10 - Math.abs(center - i),
                        willChange: "transform,opacity"
                    });

                    const tl5 = gsap.timeline({
                        scrollTrigger: {
                            trigger: sec,
                            start: "top top",
                            end: "+=" + CFG.scrollLen,
                            pin: true,
                            scrub: CFG.scrub,
                            anticipatePin: 1,
                            invalidateOnRefresh: true,
                        },
                        defaults: { ease: "none" }
                    });

                    tl5.to(cards, {
                        x: 0,
                        scale: 1,
                        autoAlpha: 1,
                        duration: 0.6,
                        ease: CFG.ease,
                        stagger: { amount: 0.28, from: "center" }
                    }, 0.06);

                    if (bottomBox) {
                        gsap.set(bottomBox, { y: 56, autoAlpha: 0, willChange: "transform,opacity" });
                        tl5.to(bottomBox, {
                            y: 0,
                            autoAlpha: 1,
                            duration: 0.35,
                            ease: CFG.ease
                        }, 0.50);
                    }
                }
                return;
            }

            // 섹션 6
            if (q(".story_sixth_box")) {
                groupA = [
                    q(".story_sixth_title1"),
                    q(".story_sixth_title2"),
                    q(".story_sixth_title3"),
                ].filter(Boolean);
            }

            // 섹션 7
            if (q(".story_seventh_box")) {
                groupA = [q(".seventh_left_box")].filter(Boolean);
                groupB = [q(".seventh_right_profile"), q(".seventh_right_desc")].filter(Boolean);
                groupC = [q(".seventh_right_last_link")].filter(Boolean);
            }

            // 공통 슬라이드업
            if (prefersReduced) {
                [...groupA, ...groupB, ...groupC].forEach(el => el && gsap.set(el, { y: 0, autoAlpha: 1 }));
                return;
            }
            [...groupA, ...groupB, ...groupC].forEach(setUp);

            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: sec,
                    start: "top top",
                    end: "+=" + CFG.scrollLen,
                    pin: true,
                    scrub: CFG.scrub,
                    anticipatePin: 1,
                    invalidateOnRefresh: true,
                },
                defaults: { ease: "none" }
            });

            let t = 0.06;
            if (groupA.length) {
                tl.to(groupA, { y: 0, autoAlpha: 1, duration: 0.35, ease: CFG.ease, stagger: 0.06 }, t);
                t += 0.20;
            }
            if (groupB.length) {
                tl.to(groupB, { y: 0, autoAlpha: 1, duration: 0.35, ease: CFG.ease, stagger: 0.05 }, t);
                t += 0.18;
            }
            if (groupC.length) {
                tl.to(groupC, { y: 0, autoAlpha: 1, duration: 0.30, ease: CFG.ease, stagger: 0.04 }, t);
            }
        }

        /* ===== 배경색 단계별 변화 ===== */
        function setupBgSteps() {
            const bg = document.querySelector('.story_bg_layer');
            const sections = [...document.querySelectorAll('.story_wrapper')];
            const total = sections.length;
            gsap.set(bg, { opacity: 0 });

            // ✅ 4번째부터 시작
            const startIndex = 3; // 배열은 0부터 시작하니까 4번째 = 인덱스 3
            const activeSections = sections.slice(startIndex); // 4~7번째만 가져옴
            const stepCount = activeSections.length; // 총 4단계

            activeSections.forEach((sec, i) => {
                const nextOpacity = (i + 1) / stepCount; // 25%, 50%, 75%, 100%
                const prevOpacity = i / stepCount;

                ScrollTrigger.create({
                    trigger: sec,
                    start: "top top",
                    end: "bottom top",
                    onEnter: () => gsap.to(bg, { opacity: nextOpacity, duration: 0.3, ease: "none" }),
                    onEnterBack: () => gsap.to(bg, { opacity: nextOpacity, duration: 0.3, ease: "none" }),
                    onLeaveBack: () => gsap.to(bg, { opacity: prevOpacity, duration: 0.3, ease: "none" }),
                });
            });

            // ✅ 마지막(7번째) 지나가면 다시 투명하게 복귀
            const last = sections[sections.length - 1];
            ScrollTrigger.create({
                trigger: last,
                start: "bottom top",
                onEnter: () => gsap.to(bg, { opacity: 0, duration: 0.6, ease: "none" }),
                onEnterBack: () => gsap.to(bg, { opacity: 1, duration: 0.6, ease: "none" }),
            });
        }

        /* ===== 초기화 ===== */
        function initStory() {
            ScrollTrigger.getAll().forEach(st => st.kill());
            gsap.killTweensOf("*");

            const sections = [...document.querySelectorAll(".story_wrapper")];
            sections.forEach((sec, idx) => buildSectionTimeline(sec, idx));

            // ✅ 배경 페이드 단계 세팅
            setupBgSteps();

            setTimeout(() => ScrollTrigger.refresh(), 0);
            window.addEventListener("load", ScrollTrigger.refresh);
            window.addEventListener("resize", ScrollTrigger.refresh);
        }

        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", initStory);
        } else {
            initStory();
        }
    </script>

</body>

</html>